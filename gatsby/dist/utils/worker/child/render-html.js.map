{"version":3,"file":"render-html.js","names":["join","path","posix","lastSessionId","htmlComponentRenderer","webpackStats","resourcesForTemplateCache","Map","inFlightResourcesForTemplate","readStaticQueryContext","templatePath","filePath","process","cwd","rawSQContext","fs","readFile","JSON","parse","clearCaches","clearStaticQueryCaches","clear","clearAssetsMappingCache","doGetResourcesForTemplate","pageData","scriptsAndStyles","getScriptsAndStylesForTemplate","componentChunkName","staticQueryContext","getStaticQueryContext","staticQueryHashes","getResourcesForTemplate","memoizedResourcesForTemplate","get","inFlight","doWorkPromise","set","resources","delete","generatePreviewErrorPage","pagePath","publicDir","error","readPageData","pageDataForErrorMessage","modifyPageDataForErrorMessage","html","stack","stringify","renderHTMLProd","htmlComponentRendererPath","paths","envVars","sessionId","webpackCompilationHash","isPreview","env","GATSBY_IS_PREVIEW","unsafeBuiltinsUsageByPagePath","previewErrors","allSlicesProps","forEach","key","value","require","readWebpackStats","global","unsafeBuiltinUsage","length","Bluebird","map","resourcesForTemplate","unsafeBuiltinsUsage","sliceData","default","context","isDuringBuild","outputFile","generateHtmlPath","e","htmlRenderError","name","message","code","concurrency","slicesPropsPerPage","renderHTMLDev","outputDir","htmlString","renderPartialHydrationProd","pathPrefix","Set","slicesMap","sliceName","Object","values","sliceDataPath","readJSON","staticQueryHash","add","Array","from","pageRenderer","getPageChunk","StaticQueryContext","renderToPipeableStream","React","chunk","outputPath","generatePageDataPath","replace","stream","createWriteStream","prefixedPagePath","pathname","search","split","pipe","createElement","Provider","ServerLocation","url","data","result","pageContext","location","hash","readFileSync","onError","partialHydrationError","emit","Promise","resolve","reject","on","renderSlices","slices","slicesProps","sliceId","props","hasChildren","sliceEntry","find","f","Error","_fileName","slice","MAGIC_CHILDREN_STRING","readSliceData","renderSlice","children","index","htmlChunk","ensureFileContent","err","renderSliceError","sliceProps"],"sources":["../../../../src/utils/worker/child/render-html.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-namespace */\n\nimport fs from \"fs-extra\"\nimport Bluebird from \"bluebird\"\nimport * as path from \"path\"\nimport { generateHtmlPath } from \"gatsby-core-utils/page-html\"\nimport { generatePageDataPath } from \"gatsby-core-utils/page-data\"\n\nimport {\n  readWebpackStats,\n  getScriptsAndStylesForTemplate,\n  clearCache as clearAssetsMappingCache,\n} from \"../../client-assets-for-template\"\nimport {\n  IPageDataWithQueryResult,\n  modifyPageDataForErrorMessage,\n  readPageData,\n  readSliceData,\n} from \"../../page-data\"\nimport type { IRenderHtmlResult } from \"../../../commands/build-html\"\nimport {\n  clearStaticQueryCaches,\n  IResourcesForTemplate,\n  getStaticQueryContext,\n} from \"../../static-query-utils\"\nimport { ServerLocation } from \"@gatsbyjs/reach-router\"\nimport { IGatsbySlice } from \"../../../internal\"\nimport { ensureFileContent } from \"../../ensure-file-content\"\n// we want to force posix-style joins, so Windows doesn't produce backslashes for urls\nconst { join } = path.posix\n\ntype IUnsafeBuiltinUsage = Array<string> | undefined\n\ndeclare global {\n  namespace NodeJS {\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    interface Global {\n      unsafeBuiltinUsage: IUnsafeBuiltinUsage\n    }\n  }\n}\n\ninterface IRenderHTMLError extends Error {\n  message: string\n  name: string\n  code?: string\n  stack?: string\n  context?: {\n    path?: string\n    unsafeBuiltinsUsageByPagePath?: Record<string, IUnsafeBuiltinUsage>\n  }\n}\n\n/**\n * Used to track if renderHTMLProd / renderHTMLDev are called within same \"session\" (from same renderHTMLQueue call).\n * As long as sessionId remains the same we can rely on memoized/cached resources for templates, css file content for inlining and static query results.\n * If session changes we invalidate our memoization caches.\n */\nlet lastSessionId = 0\nlet htmlComponentRenderer\nlet webpackStats\n\nconst resourcesForTemplateCache = new Map<string, IResourcesForTemplate>()\nconst inFlightResourcesForTemplate = new Map<\n  string,\n  Promise<IResourcesForTemplate>\n>()\n\nconst readStaticQueryContext = async (\n  templatePath: string\n): Promise<Record<string, { data: unknown }>> => {\n  const filePath = path.join(\n    // TODO: Better way to get this?\n    process.cwd(),\n    `.cache`,\n    `page-ssr`,\n    `sq-context`,\n    templatePath,\n    `sq-context.json`\n  )\n  const rawSQContext = await fs.readFile(filePath, `utf-8`)\n\n  return JSON.parse(rawSQContext)\n}\n\nfunction clearCaches(): void {\n  clearStaticQueryCaches()\n  resourcesForTemplateCache.clear()\n  inFlightResourcesForTemplate.clear()\n\n  clearAssetsMappingCache()\n}\n\nasync function doGetResourcesForTemplate(\n  pageData: IPageDataWithQueryResult\n): Promise<IResourcesForTemplate> {\n  const scriptsAndStyles = await getScriptsAndStylesForTemplate(\n    pageData.componentChunkName,\n    webpackStats\n  )\n\n  const { staticQueryContext } = await getStaticQueryContext(\n    pageData.staticQueryHashes\n  )\n\n  return {\n    staticQueryContext,\n    ...scriptsAndStyles,\n  }\n}\n\nasync function getResourcesForTemplate(\n  pageData: IPageDataWithQueryResult\n): Promise<IResourcesForTemplate> {\n  const memoizedResourcesForTemplate = resourcesForTemplateCache.get(\n    pageData.componentChunkName\n  )\n  if (memoizedResourcesForTemplate) {\n    return memoizedResourcesForTemplate\n  }\n\n  const inFlight = inFlightResourcesForTemplate.get(pageData.componentChunkName)\n  if (inFlight) {\n    return inFlight\n  }\n\n  const doWorkPromise = doGetResourcesForTemplate(pageData)\n  inFlightResourcesForTemplate.set(pageData.componentChunkName, doWorkPromise)\n\n  const resources = await doWorkPromise\n\n  resourcesForTemplateCache.set(pageData.componentChunkName, resources)\n  inFlightResourcesForTemplate.delete(pageData.componentChunkName)\n\n  return resources\n}\n\ninterface IPreviewErrorProps {\n  pagePath: string\n  publicDir: string\n  error: IRenderHTMLError\n}\n\nconst generatePreviewErrorPage = async ({\n  pagePath,\n  publicDir,\n  error,\n}: IPreviewErrorProps): Promise<string> => {\n  const pageData = await readPageData(publicDir, pagePath)\n  const pageDataForErrorMessage = modifyPageDataForErrorMessage(pageData)\n\n  const html = `<!doctype html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\"/>\n    <title>Failed to render HTML for \"${pagePath}\"</title>\n    <style>\n      *, *::before, *::after {\n        box-sizing: border-box;\n      }\n      * {\n        margin: 0;\n      }\n      html, body {\n        height: 100%;\n      }\n      body {\n        line-height: 1.5;\n        -webkit-font-smoothing: antialiased;\n      }\n      img, picture, video, canvas, svg {\n        display: block;\n        max-width: 100%;\n      }\n      input, button, textarea, select {\n        font: inherit;\n      }\n      p, h1, h2, h3, h4, h5, h6 {\n        overflow-wrap: break-word;\n      }\n\n      :root {\n        --color-ansi-selection: rgba(95, 126, 151, 0.48);\n        --color-ansi-bg: #fafafa;\n        --color-ansi-fg: #545454;\n        --color-ansi-white: #969896;\n        --color-ansi-black: #141414;\n        --color-ansi-blue: #183691;\n        --color-ansi-cyan: #007faa;\n        --color-ansi-green: #008000;\n        --color-ansi-magenta: #795da3;\n        --color-ansi-red: #d91e18;\n        --color-ansi-yellow: #aa5d00;\n        --color-ansi-bright-white: #ffffff;\n        --color-ansi-bright-black: #545454;\n        --color-ansi-bright-blue: #183691;\n        --color-ansi-bright-cyan: #007faa;\n        --color-ansi-bright-green: #008000;\n        --color-ansi-bright-magenta: #795da3;\n        --color-ansi-bright-red: #d91e18;\n        --color-ansi-bright-yellow: #aa5d00;\n        --importantLight: #ffffff;\n        --importantDark: #000000;\n        --backdrop: rgba(72, 67, 79, 0.5);\n        --color: #454a53;\n        --background: var(--color-ansi-bright-white);\n        --primary: #663399;\n        --primaryLight: #9158ca;\n        --link: var(--primary);\n        --line: #e0e0e0;\n        --colorHeader: rgb(244, 244, 244);\n        --codeFrame-bg: #eeeeee;\n        --codeFrame-color: #414141;\n        --codeFrame-button-bg: white;\n        --radii: 5px;\n        --z-index-backdrop: 9000;\n        --z-index-overlay: 10000;\n        --space-xxs: 0.25em;\n        --space-xs: 0.5em;\n        --space-sm: 1em;\n        --space: 1.5em;\n        --space-lg: 2.5em;\n        --rootBoxShadowOpacity: 0.08;\n        --ring-opacity: 0.65;\n        --ring-color: rgba(138, 75, 175, var(--ring-opacity));\n      }\n\n      html {\n        font: 18px/1.5 -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\";\n        background: var(--background);\n        color: var(--color);\n      }\n\n      a {\n        color: var(--link);\n        text-decoration: none;\n        font-weight: 500;\n      }\n\n      button:focus, a:focus {\n        outline: 4px solid transparent;\n        box-shadow: 0 0 0 4px var(--ring-color);\n      }\n\n      a:hover {\n        text-decoration: underline;\n      }\n\n      header {\n        color: var(--colorHeader);\n        background: var(--primary);\n        padding: var(--space);\n      }\n\n      header p {\n        margin-bottom: 0;\n      }\n\n      h1 {\n        color: var(--importantLight);\n        font-weight: 500;\n        margin: 0;\n      }\n\n      main {\n        padding: var(--space);\n      }\n\n      h2 {\n        font-weight: 500;\n        font-size: 1.25em;\n        color: var(--importantDark);\n        margin-bottom: var(--space-xs);\n      }\n\n      p {\n        margin-bottom: var(--space-sm);\n      }\n\n      pre {\n        color: var(--color-ansi-fg);\n        background: var(--color-ansi-bg);\n        padding: var(--space-sm);\n        border-radius: var(--radii);\n        overflow: auto;\n        margin-bottom: var(--space-sm);\n      }\n\n      p code {\n        color: var(--color-ansi-fg);\n        background: var(--color-ansi-bg);\n        border-radius: var(--radii);\n        padding: var(--space-xxs)\n      }\n\n      @media (prefers-color-scheme: dark) {\n        :root {\n          --color-ansi-bg: #2b2b2b;\n          --color-ansi-fg: #d1d5db;\n          --color-ansi-white: #ffffff;\n          --color-ansi-black: #d4d0ab;\n          --color-ansi-blue: #4791ff;\n          --color-ansi-cyan: #00e0e0;\n          --color-ansi-green: #abe338;\n          --color-ansi-magenta: #dcc6e0;\n          --color-ansi-red: #ffa07a;\n          --color-ansi-yellow: #ffd700;\n          --color-ansi-bright-white: #ffffff;\n          --color-ansi-bright-black: #d4d0ab;\n          --color-ansi-bright-blue: #4791ff;\n          --color-ansi-bright-cyan: #00e0e0;\n          --color-ansi-bright-green: #abe338;\n          --color-ansi-bright-magenta: #dcc6e0;\n          --color-ansi-bright-red: #ffa07a;\n          --color-ansi-bright-yellow: #ffd700;\n          --importantDark: white;\n          --backdrop: rgba(48, 48, 50, 0.75);\n          --color: #d1d5db;\n          --link: #d9bae8;\n          --background: #232129;\n          --primary: #452475;\n          --primaryLight: #663399;\n          --line: #464647;\n          --codeFrame-bg: #18171d;\n          --codeFrame-color: #d1d5db;\n          --codeFrame-button-bg: #232129;\n          --rootBoxShadowOpacity: 0.15;\n          --ring-color: rgba(217, 186, 232, var(--ring-opacity));\n        }\n      }\n    </style>\n  </head>\n  <body>\n    <header>\n      <h1>Failed to render HTML</h1>\n      <p>The error occurred on the page: <strong>${pagePath}</strong></p>\n    </header>\n    <main>\n      <p>While trying to render the HTML for \"${pagePath}\" an error occurred. In order to make the build succeed you'll need to fix the error in your site. See the stacktrace below to find the culprit. Also be sure to read <a href=\"https://www.gatsbyjs.com/docs/debugging-html-builds/\">Debugging HTML Builds</a> if you need more help.</p>\n      <h2>Error</h2>\n      <pre><code>${\n        error.stack ? error.stack : `No codeFrame could be generated.`\n      }</code></pre>\n      <h2>Extra Details</h2>\n      <p>Below you'll find additional data that might help you debug the error.</p>\n      <details>\n        <summary>Page Data</summary>\n        <p>The page data contains some metadata about the affected page. If data from the GraphQL is undefined, try running the query in the GraphiQL IDE.</p>\n        <pre><code>${JSON.stringify(\n          pageDataForErrorMessage,\n          null,\n          2\n        )}</code></pre>\n      </details>\n    </main>\n  </body>\n</html>\n`\n\n  return html\n}\n\nexport const renderHTMLProd = async ({\n  htmlComponentRendererPath,\n  paths,\n  envVars,\n  sessionId,\n  webpackCompilationHash,\n}: {\n  htmlComponentRendererPath: string\n  paths: Array<string>\n  envVars: Array<[string, string | undefined]>\n  sessionId: number\n  webpackCompilationHash: string\n}): Promise<IRenderHtmlResult> => {\n  const publicDir = join(process.cwd(), `public`)\n  const isPreview = process.env.GATSBY_IS_PREVIEW === `true`\n\n  const unsafeBuiltinsUsageByPagePath = {}\n  const previewErrors = {}\n  const allSlicesProps = {}\n\n  // Check if we need to do setup and cache clearing. Within same session we can reuse memoized data,\n  // but it's not safe to reuse them in different sessions. Check description of `lastSessionId` for more details\n  if (sessionId !== lastSessionId) {\n    clearCaches()\n\n    // This is being executed in child process, so we need to set some vars\n    // for modules that aren't bundled by webpack.\n    envVars.forEach(([key, value]) => (process.env[key] = value))\n\n    htmlComponentRenderer = require(htmlComponentRendererPath)\n\n    webpackStats = await readWebpackStats(publicDir)\n\n    lastSessionId = sessionId\n\n    if (global.unsafeBuiltinUsage && global.unsafeBuiltinUsage.length > 0) {\n      unsafeBuiltinsUsageByPagePath[`__import_time__`] =\n        global.unsafeBuiltinUsage\n    }\n  }\n\n  await Bluebird.map(\n    paths,\n    async pagePath => {\n      try {\n        const pageData = await readPageData(publicDir, pagePath)\n        const resourcesForTemplate = await getResourcesForTemplate(pageData)\n\n        const { html, unsafeBuiltinsUsage, sliceData } =\n          await htmlComponentRenderer.default({\n            pagePath,\n            pageData,\n            webpackCompilationHash,\n            context: {\n              isDuringBuild: true,\n            },\n            ...resourcesForTemplate,\n          })\n\n        allSlicesProps[pagePath] = sliceData\n\n        if (unsafeBuiltinsUsage.length > 0) {\n          unsafeBuiltinsUsageByPagePath[pagePath] = unsafeBuiltinsUsage\n        }\n\n        await fs.outputFile(generateHtmlPath(publicDir, pagePath), html)\n      } catch (e) {\n        if (e.unsafeBuiltinsUsage && e.unsafeBuiltinsUsage.length > 0) {\n          unsafeBuiltinsUsageByPagePath[pagePath] = e.unsafeBuiltinsUsage\n        }\n\n        const htmlRenderError: IRenderHTMLError = e\n\n        htmlRenderError.context = {\n          path: pagePath,\n          unsafeBuiltinsUsageByPagePath,\n        }\n\n        // If we're in Preview-mode, write out a simple error html file.\n        if (isPreview) {\n          const html = await generatePreviewErrorPage({\n            pagePath,\n            publicDir,\n            error: htmlRenderError,\n          })\n\n          await fs.outputFile(generateHtmlPath(publicDir, pagePath), html)\n          previewErrors[pagePath] = {\n            e: htmlRenderError,\n            name: htmlRenderError.name,\n            message: htmlRenderError.message,\n            code: htmlRenderError?.code,\n            stack: htmlRenderError?.stack,\n          }\n        } else {\n          throw e\n        }\n      }\n    },\n    { concurrency: 2 }\n  )\n\n  return {\n    unsafeBuiltinsUsageByPagePath,\n    previewErrors,\n    slicesPropsPerPage: allSlicesProps,\n  }\n}\n\n// TODO: remove when DEV_SSR is done\nexport const renderHTMLDev = async ({\n  htmlComponentRendererPath,\n  paths,\n  envVars,\n  sessionId,\n}: {\n  htmlComponentRendererPath: string\n  paths: Array<string>\n  envVars: Array<[string, string | undefined]>\n  sessionId: number\n}): Promise<Array<unknown>> => {\n  const outputDir = join(process.cwd(), `.cache`, `develop-html`)\n\n  // Check if we need to do setup and cache clearing. Within same session we can reuse memoized data,\n  // but it's not safe to reuse them in different sessions. Check description of `lastSessionId` for more details\n  if (sessionId !== lastSessionId) {\n    clearCaches()\n\n    // This is being executed in child process, so we need to set some vars\n    // for modules that aren't bundled by webpack.\n    envVars.forEach(([key, value]) => (process.env[key] = value))\n\n    htmlComponentRenderer = require(htmlComponentRendererPath)\n\n    lastSessionId = sessionId\n  }\n\n  return Bluebird.map(\n    paths,\n    async pagePath => {\n      try {\n        const htmlString = await htmlComponentRenderer.default({\n          pagePath,\n          context: {\n            isDuringBuild: true,\n          },\n        })\n        return fs.outputFile(generateHtmlPath(outputDir, pagePath), htmlString)\n      } catch (e) {\n        // add some context to error so we can display more helpful message\n        e.context = {\n          path: pagePath,\n        }\n        throw e\n      }\n    },\n    { concurrency: 2 }\n  )\n}\n\nexport async function renderPartialHydrationProd({\n  paths,\n  envVars,\n  sessionId,\n  pathPrefix,\n}: {\n  paths: Array<string>\n  envVars: Array<[string, string | undefined]>\n  sessionId: number\n  pathPrefix\n}): Promise<void> {\n  const publicDir = join(process.cwd(), `public`)\n\n  const unsafeBuiltinsUsageByPagePath = {}\n\n  // Check if we need to do setup and cache clearing. Within same session we can reuse memoized data,\n  // but it's not safe to reuse them in different sessions. Check description of `lastSessionId` for more details\n  if (sessionId !== lastSessionId) {\n    clearCaches()\n\n    // This is being executed in child process, so we need to set some vars\n    // for modules that aren't bundled by webpack.\n    envVars.forEach(([key, value]) => (process.env[key] = value))\n\n    webpackStats = await readWebpackStats(publicDir)\n\n    lastSessionId = sessionId\n\n    if (global.unsafeBuiltinUsage && global.unsafeBuiltinUsage.length > 0) {\n      unsafeBuiltinsUsageByPagePath[`__import_time__`] =\n        global.unsafeBuiltinUsage\n    }\n  }\n\n  for (const pagePath of paths) {\n    const pageData = await readPageData(publicDir, pagePath)\n\n    // we collect static query hashes from page template and also all used slices on the page\n    const staticQueryHashes = new Set(pageData.staticQueryHashes)\n    if (pageData.slicesMap) {\n      for (const sliceName of Object.values(pageData.slicesMap)) {\n        const sliceDataPath = path.join(\n          publicDir,\n          `slice-data`,\n          `${sliceName}.json`\n        )\n        const sliceData = await fs.readJSON(sliceDataPath)\n        for (const staticQueryHash of sliceData.staticQueryHashes) {\n          staticQueryHashes.add(staticQueryHash)\n        }\n      }\n    }\n\n    const { staticQueryContext } = await getStaticQueryContext(\n      Array.from(staticQueryHashes)\n    )\n\n    const pageRenderer = path.join(\n      process.cwd(),\n      `.cache`,\n      `partial-hydration`,\n      `render-page`\n    )\n\n    const {\n      getPageChunk,\n      StaticQueryContext,\n      renderToPipeableStream,\n      React,\n    } = require(pageRenderer)\n    const chunk = await getPageChunk({\n      componentChunkName: pageData.componentChunkName,\n    })\n    const outputPath = generatePageDataPath(\n      path.join(process.cwd(), `public`),\n      pagePath\n    ).replace(`.json`, `-rsc.json`)\n\n    const stream = fs.createWriteStream(outputPath)\n\n    const prefixedPagePath = pathPrefix\n      ? `${pathPrefix}${pageData.path}`\n      : pageData.path\n    const [pathname, search = ``] = prefixedPagePath.split(`?`)\n\n    const { pipe } = renderToPipeableStream(\n      React.createElement(\n        StaticQueryContext.Provider,\n        { value: staticQueryContext },\n        [\n          // Make `useLocation` hook usuable in children\n          React.createElement(\n            ServerLocation,\n            { key: `partial-hydration-server-location`, url: pageData.path },\n            [\n              React.createElement(chunk.default, {\n                key: `partial-hydration-page`,\n                data: pageData.result.data,\n                pageContext: pageData.result.pageContext,\n                // Make location available to page as props, logic extracted from `LocationProvider`\n                location: {\n                  pathname,\n                  search,\n                  hash: ``,\n                },\n              }),\n            ]\n          ),\n        ]\n      ),\n      JSON.parse(\n        fs.readFileSync(\n          path.join(\n            process.cwd(),\n            `.cache`,\n            `partial-hydration`,\n            `manifest.json`\n          ),\n          `utf8`\n        )\n      ),\n      {\n        // React spits out the error here and does not emit it, we want to emit it\n        // so we can reject with the error and handle it upstream\n        onError: error => {\n          const partialHydrationError: IRenderHTMLError = error\n\n          partialHydrationError.context = {\n            path: pagePath,\n            unsafeBuiltinsUsageByPagePath,\n          }\n\n          stream.emit(`error`, error)\n        },\n      }\n    )\n\n    await new Promise<void>((resolve, reject) => {\n      stream.on(`error`, (error: IRenderHTMLError) => {\n        reject(error)\n      })\n\n      stream.on(`close`, () => {\n        resolve()\n      })\n\n      pipe(stream)\n    })\n  }\n}\n\nexport interface IRenderSliceResult {\n  chunks: 2 | 1\n}\n\nexport interface IRenderSlicesResults {\n  [sliceName: string]: IRenderSliceResult\n}\n\nexport interface ISlicePropsEntry {\n  sliceId: string\n  sliceName: string\n  props: Record<string, unknown>\n  hasChildren: boolean\n}\n\ninterface IRenderSliceHTMLError extends Error {\n  message: string\n  name: string\n  code?: string\n  stack?: string\n  context?: {\n    sliceName?: string\n    sliceData: unknown\n    sliceProps: unknown\n  }\n}\n\nexport async function renderSlices({\n  slices,\n  htmlComponentRendererPath,\n  publicDir,\n  slicesProps,\n}: {\n  publicDir: string\n  slices: Array<[string, IGatsbySlice]>\n  slicesProps: Array<ISlicePropsEntry>\n  htmlComponentRendererPath: string\n}): Promise<void> {\n  const htmlComponentRenderer = require(htmlComponentRendererPath)\n\n  for (const { sliceId, props, sliceName, hasChildren } of slicesProps) {\n    const sliceEntry = slices.find(f => f[0] === sliceName)\n    if (!sliceEntry) {\n      throw new Error(\n        `Slice name \"${sliceName}\" not found when rendering slices`\n      )\n    }\n\n    const [_fileName, slice] = sliceEntry\n\n    const staticQueryContext = await readStaticQueryContext(\n      slice.componentChunkName\n    )\n\n    const MAGIC_CHILDREN_STRING = `__DO_NOT_USE_OR_ELSE__`\n    const sliceData = await readSliceData(publicDir, slice.name)\n\n    try {\n      const html = await htmlComponentRenderer.renderSlice({\n        slice,\n        staticQueryContext,\n        props: {\n          data: sliceData?.result?.data,\n          ...(hasChildren ? { children: MAGIC_CHILDREN_STRING } : {}),\n          ...props,\n        },\n      })\n      const split = html.split(MAGIC_CHILDREN_STRING)\n\n      // TODO always generate both for now\n      let index = 1\n      for (const htmlChunk of split) {\n        await ensureFileContent(\n          path.join(publicDir, `_gatsby`, `slices`, `${sliceId}-${index}.html`),\n          htmlChunk\n        )\n        index++\n      }\n    } catch (err) {\n      const renderSliceError: IRenderSliceHTMLError = err\n      renderSliceError.context = {\n        sliceName,\n        sliceData,\n        sliceProps: props,\n      }\n      throw renderSliceError\n    }\n  }\n}\n"],"mappings":";;;;;;;;;AAEA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AAKA;;AAOA;;AAKA;;AAEA;;;;;;AA3BA;AA4BA;AACA,MAAM;EAAEA;AAAF,IAAWC,IAAI,CAACC,KAAtB;;AAwBA;AACA;AACA;AACA;AACA;AACA,IAAIC,aAAa,GAAG,CAApB;AACA,IAAIC,qBAAJ;AACA,IAAIC,YAAJ;AAEA,MAAMC,yBAAyB,GAAG,IAAIC,GAAJ,EAAlC;AACA,MAAMC,4BAA4B,GAAG,IAAID,GAAJ,EAArC;;AAKA,MAAME,sBAAsB,GAAG,MAC7BC,YAD6B,IAEkB;EAC/C,MAAMC,QAAQ,GAAGV,IAAI,CAACD,IAAL,EACf;EACAY,OAAO,CAACC,GAAR,EAFe,EAGd,QAHc,EAId,UAJc,EAKd,YALc,EAMfH,YANe,EAOd,iBAPc,CAAjB;EASA,MAAMI,YAAY,GAAG,MAAMC,gBAAA,CAAGC,QAAH,CAAYL,QAAZ,EAAuB,OAAvB,CAA3B;EAEA,OAAOM,IAAI,CAACC,KAAL,CAAWJ,YAAX,CAAP;AACD,CAfD;;AAiBA,SAASK,WAAT,GAA6B;EAC3B,IAAAC,wCAAA;EACAd,yBAAyB,CAACe,KAA1B;EACAb,4BAA4B,CAACa,KAA7B;EAEA,IAAAC,mCAAA;AACD;;AAED,eAAeC,yBAAf,CACEC,QADF,EAEkC;EAChC,MAAMC,gBAAgB,GAAG,MAAM,IAAAC,uDAAA,EAC7BF,QAAQ,CAACG,kBADoB,EAE7BtB,YAF6B,CAA/B;EAKA,MAAM;IAAEuB;EAAF,IAAyB,MAAM,IAAAC,uCAAA,EACnCL,QAAQ,CAACM,iBAD0B,CAArC;EAIA,OAAO;IACLF,kBADK;IAEL,GAAGH;EAFE,CAAP;AAID;;AAED,eAAeM,uBAAf,CACEP,QADF,EAEkC;EAChC,MAAMQ,4BAA4B,GAAG1B,yBAAyB,CAAC2B,GAA1B,CACnCT,QAAQ,CAACG,kBAD0B,CAArC;;EAGA,IAAIK,4BAAJ,EAAkC;IAChC,OAAOA,4BAAP;EACD;;EAED,MAAME,QAAQ,GAAG1B,4BAA4B,CAACyB,GAA7B,CAAiCT,QAAQ,CAACG,kBAA1C,CAAjB;;EACA,IAAIO,QAAJ,EAAc;IACZ,OAAOA,QAAP;EACD;;EAED,MAAMC,aAAa,GAAGZ,yBAAyB,CAACC,QAAD,CAA/C;EACAhB,4BAA4B,CAAC4B,GAA7B,CAAiCZ,QAAQ,CAACG,kBAA1C,EAA8DQ,aAA9D;EAEA,MAAME,SAAS,GAAG,MAAMF,aAAxB;EAEA7B,yBAAyB,CAAC8B,GAA1B,CAA8BZ,QAAQ,CAACG,kBAAvC,EAA2DU,SAA3D;EACA7B,4BAA4B,CAAC8B,MAA7B,CAAoCd,QAAQ,CAACG,kBAA7C;EAEA,OAAOU,SAAP;AACD;;AAQD,MAAME,wBAAwB,GAAG,OAAO;EACtCC,QADsC;EAEtCC,SAFsC;EAGtCC;AAHsC,CAAP,KAIU;EACzC,MAAMlB,QAAQ,GAAG,MAAM,IAAAmB,uBAAA,EAAaF,SAAb,EAAwBD,QAAxB,CAAvB;EACA,MAAMI,uBAAuB,GAAG,IAAAC,wCAAA,EAA8BrB,QAA9B,CAAhC;EAEA,MAAMsB,IAAI,GAAI;AAChB;AACA;AACA;AACA,wCAAwCN,QAAS;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmDA,QAAS;AAC5D;AACA;AACA,gDAAgDA,QAAS;AACzD;AACA,mBACQE,KAAK,CAACK,KAAN,GAAcL,KAAK,CAACK,KAApB,GAA6B,kCAC9B;AACP;AACA;AACA;AACA;AACA;AACA,qBAAqB9B,IAAI,CAAC+B,SAAL,CACXJ,uBADW,EAEX,IAFW,EAGX,CAHW,CAIX;AACV;AACA;AACA;AACA;AACA,CA9ME;EAgNA,OAAOE,IAAP;AACD,CAzND;;AA2NO,MAAMG,cAAc,GAAG,OAAO;EACnCC,yBADmC;EAEnCC,KAFmC;EAGnCC,OAHmC;EAInCC,SAJmC;EAKnCC;AALmC,CAAP,KAYI;EAChC,MAAMb,SAAS,GAAGzC,IAAI,CAACY,OAAO,CAACC,GAAR,EAAD,EAAiB,QAAjB,CAAtB;EACA,MAAM0C,SAAS,GAAG3C,OAAO,CAAC4C,GAAR,CAAYC,iBAAZ,KAAmC,MAArD;EAEA,MAAMC,6BAA6B,GAAG,EAAtC;EACA,MAAMC,aAAa,GAAG,EAAtB;EACA,MAAMC,cAAc,GAAG,EAAvB,CANgC,CAQhC;EACA;;EACA,IAAIP,SAAS,KAAKlD,aAAlB,EAAiC;IAC/BgB,WAAW,GADoB,CAG/B;IACA;;IACAiC,OAAO,CAACS,OAAR,CAAgB,CAAC,CAACC,GAAD,EAAMC,KAAN,CAAD,KAAmBnD,OAAO,CAAC4C,GAAR,CAAYM,GAAZ,IAAmBC,KAAtD;IAEA3D,qBAAqB,GAAG4D,OAAO,CAACd,yBAAD,CAA/B;IAEA7C,YAAY,GAAG,MAAM,IAAA4D,yCAAA,EAAiBxB,SAAjB,CAArB;IAEAtC,aAAa,GAAGkD,SAAhB;;IAEA,IAAIa,MAAM,CAACC,kBAAP,IAA6BD,MAAM,CAACC,kBAAP,CAA0BC,MAA1B,GAAmC,CAApE,EAAuE;MACrEV,6BAA6B,CAAE,iBAAF,CAA7B,GACEQ,MAAM,CAACC,kBADT;IAED;EACF;;EAED,MAAME,iBAAA,CAASC,GAAT,CACJnB,KADI,EAEJ,MAAMX,QAAN,IAAkB;IAChB,IAAI;MACF,MAAMhB,QAAQ,GAAG,MAAM,IAAAmB,uBAAA,EAAaF,SAAb,EAAwBD,QAAxB,CAAvB;MACA,MAAM+B,oBAAoB,GAAG,MAAMxC,uBAAuB,CAACP,QAAD,CAA1D;MAEA,MAAM;QAAEsB,IAAF;QAAQ0B,mBAAR;QAA6BC;MAA7B,IACJ,MAAMrE,qBAAqB,CAACsE,OAAtB,CAA8B;QAClClC,QADkC;QAElChB,QAFkC;QAGlC8B,sBAHkC;QAIlCqB,OAAO,EAAE;UACPC,aAAa,EAAE;QADR,CAJyB;QAOlC,GAAGL;MAP+B,CAA9B,CADR;MAWAX,cAAc,CAACpB,QAAD,CAAd,GAA2BiC,SAA3B;;MAEA,IAAID,mBAAmB,CAACJ,MAApB,GAA6B,CAAjC,EAAoC;QAClCV,6BAA6B,CAAClB,QAAD,CAA7B,GAA0CgC,mBAA1C;MACD;;MAED,MAAMzD,gBAAA,CAAG8D,UAAH,CAAc,IAAAC,0BAAA,EAAiBrC,SAAjB,EAA4BD,QAA5B,CAAd,EAAqDM,IAArD,CAAN;IACD,CAtBD,CAsBE,OAAOiC,CAAP,EAAU;MACV,IAAIA,CAAC,CAACP,mBAAF,IAAyBO,CAAC,CAACP,mBAAF,CAAsBJ,MAAtB,GAA+B,CAA5D,EAA+D;QAC7DV,6BAA6B,CAAClB,QAAD,CAA7B,GAA0CuC,CAAC,CAACP,mBAA5C;MACD;;MAED,MAAMQ,eAAiC,GAAGD,CAA1C;MAEAC,eAAe,CAACL,OAAhB,GAA0B;QACxB1E,IAAI,EAAEuC,QADkB;QAExBkB;MAFwB,CAA1B,CAPU,CAYV;;MACA,IAAIH,SAAJ,EAAe;QACb,MAAMT,IAAI,GAAG,MAAMP,wBAAwB,CAAC;UAC1CC,QAD0C;UAE1CC,SAF0C;UAG1CC,KAAK,EAAEsC;QAHmC,CAAD,CAA3C;QAMA,MAAMjE,gBAAA,CAAG8D,UAAH,CAAc,IAAAC,0BAAA,EAAiBrC,SAAjB,EAA4BD,QAA5B,CAAd,EAAqDM,IAArD,CAAN;QACAa,aAAa,CAACnB,QAAD,CAAb,GAA0B;UACxBuC,CAAC,EAAEC,eADqB;UAExBC,IAAI,EAAED,eAAe,CAACC,IAFE;UAGxBC,OAAO,EAAEF,eAAe,CAACE,OAHD;UAIxBC,IAAI,EAAEH,eAAF,aAAEA,eAAF,uBAAEA,eAAe,CAAEG,IAJC;UAKxBpC,KAAK,EAAEiC,eAAF,aAAEA,eAAF,uBAAEA,eAAe,CAAEjC;QALA,CAA1B;MAOD,CAfD,MAeO;QACL,MAAMgC,CAAN;MACD;IACF;EACF,CAzDG,EA0DJ;IAAEK,WAAW,EAAE;EAAf,CA1DI,CAAN;EA6DA,OAAO;IACL1B,6BADK;IAELC,aAFK;IAGL0B,kBAAkB,EAAEzB;EAHf,CAAP;AAKD,CA3GM,C,CA6GP;;;;;AACO,MAAM0B,aAAa,GAAG,OAAO;EAClCpC,yBADkC;EAElCC,KAFkC;EAGlCC,OAHkC;EAIlCC;AAJkC,CAAP,KAUE;EAC7B,MAAMkC,SAAS,GAAGvF,IAAI,CAACY,OAAO,CAACC,GAAR,EAAD,EAAiB,QAAjB,EAA2B,cAA3B,CAAtB,CAD6B,CAG7B;EACA;;EACA,IAAIwC,SAAS,KAAKlD,aAAlB,EAAiC;IAC/BgB,WAAW,GADoB,CAG/B;IACA;;IACAiC,OAAO,CAACS,OAAR,CAAgB,CAAC,CAACC,GAAD,EAAMC,KAAN,CAAD,KAAmBnD,OAAO,CAAC4C,GAAR,CAAYM,GAAZ,IAAmBC,KAAtD;IAEA3D,qBAAqB,GAAG4D,OAAO,CAACd,yBAAD,CAA/B;IAEA/C,aAAa,GAAGkD,SAAhB;EACD;;EAED,OAAOgB,iBAAA,CAASC,GAAT,CACLnB,KADK,EAEL,MAAMX,QAAN,IAAkB;IAChB,IAAI;MACF,MAAMgD,UAAU,GAAG,MAAMpF,qBAAqB,CAACsE,OAAtB,CAA8B;QACrDlC,QADqD;QAErDmC,OAAO,EAAE;UACPC,aAAa,EAAE;QADR;MAF4C,CAA9B,CAAzB;MAMA,OAAO7D,gBAAA,CAAG8D,UAAH,CAAc,IAAAC,0BAAA,EAAiBS,SAAjB,EAA4B/C,QAA5B,CAAd,EAAqDgD,UAArD,CAAP;IACD,CARD,CAQE,OAAOT,CAAP,EAAU;MACV;MACAA,CAAC,CAACJ,OAAF,GAAY;QACV1E,IAAI,EAAEuC;MADI,CAAZ;MAGA,MAAMuC,CAAN;IACD;EACF,CAlBI,EAmBL;IAAEK,WAAW,EAAE;EAAf,CAnBK,CAAP;AAqBD,CAhDM;;;;AAkDA,eAAeK,0BAAf,CAA0C;EAC/CtC,KAD+C;EAE/CC,OAF+C;EAG/CC,SAH+C;EAI/CqC;AAJ+C,CAA1C,EAUW;EAChB,MAAMjD,SAAS,GAAGzC,IAAI,CAACY,OAAO,CAACC,GAAR,EAAD,EAAiB,QAAjB,CAAtB;EAEA,MAAM6C,6BAA6B,GAAG,EAAtC,CAHgB,CAKhB;EACA;;EACA,IAAIL,SAAS,KAAKlD,aAAlB,EAAiC;IAC/BgB,WAAW,GADoB,CAG/B;IACA;;IACAiC,OAAO,CAACS,OAAR,CAAgB,CAAC,CAACC,GAAD,EAAMC,KAAN,CAAD,KAAmBnD,OAAO,CAAC4C,GAAR,CAAYM,GAAZ,IAAmBC,KAAtD;IAEA1D,YAAY,GAAG,MAAM,IAAA4D,yCAAA,EAAiBxB,SAAjB,CAArB;IAEAtC,aAAa,GAAGkD,SAAhB;;IAEA,IAAIa,MAAM,CAACC,kBAAP,IAA6BD,MAAM,CAACC,kBAAP,CAA0BC,MAA1B,GAAmC,CAApE,EAAuE;MACrEV,6BAA6B,CAAE,iBAAF,CAA7B,GACEQ,MAAM,CAACC,kBADT;IAED;EACF;;EAED,KAAK,MAAM3B,QAAX,IAAuBW,KAAvB,EAA8B;IAC5B,MAAM3B,QAAQ,GAAG,MAAM,IAAAmB,uBAAA,EAAaF,SAAb,EAAwBD,QAAxB,CAAvB,CAD4B,CAG5B;;IACA,MAAMV,iBAAiB,GAAG,IAAI6D,GAAJ,CAAQnE,QAAQ,CAACM,iBAAjB,CAA1B;;IACA,IAAIN,QAAQ,CAACoE,SAAb,EAAwB;MACtB,KAAK,MAAMC,SAAX,IAAwBC,MAAM,CAACC,MAAP,CAAcvE,QAAQ,CAACoE,SAAvB,CAAxB,EAA2D;QACzD,MAAMI,aAAa,GAAG/F,IAAI,CAACD,IAAL,CACpByC,SADoB,EAEnB,YAFmB,EAGnB,GAAEoD,SAAU,OAHO,CAAtB;QAKA,MAAMpB,SAAS,GAAG,MAAM1D,gBAAA,CAAGkF,QAAH,CAAYD,aAAZ,CAAxB;;QACA,KAAK,MAAME,eAAX,IAA8BzB,SAAS,CAAC3C,iBAAxC,EAA2D;UACzDA,iBAAiB,CAACqE,GAAlB,CAAsBD,eAAtB;QACD;MACF;IACF;;IAED,MAAM;MAAEtE;IAAF,IAAyB,MAAM,IAAAC,uCAAA,EACnCuE,KAAK,CAACC,IAAN,CAAWvE,iBAAX,CADmC,CAArC;IAIA,MAAMwE,YAAY,GAAGrG,IAAI,CAACD,IAAL,CACnBY,OAAO,CAACC,GAAR,EADmB,EAElB,QAFkB,EAGlB,mBAHkB,EAIlB,aAJkB,CAArB;;IAOA,MAAM;MACJ0F,YADI;MAEJC,kBAFI;MAGJC,sBAHI;MAIJC;IAJI,IAKF1C,OAAO,CAACsC,YAAD,CALX;;IAMA,MAAMK,KAAK,GAAG,MAAMJ,YAAY,CAAC;MAC/B5E,kBAAkB,EAAEH,QAAQ,CAACG;IADE,CAAD,CAAhC;IAGA,MAAMiF,UAAU,GAAG,IAAAC,8BAAA,EACjB5G,IAAI,CAACD,IAAL,CAAUY,OAAO,CAACC,GAAR,EAAV,EAA0B,QAA1B,CADiB,EAEjB2B,QAFiB,EAGjBsE,OAHiB,CAGR,OAHQ,EAGC,WAHD,CAAnB;;IAKA,MAAMC,MAAM,GAAGhG,gBAAA,CAAGiG,iBAAH,CAAqBJ,UAArB,CAAf;;IAEA,MAAMK,gBAAgB,GAAGvB,UAAU,GAC9B,GAAEA,UAAW,GAAElE,QAAQ,CAACvB,IAAK,EADC,GAE/BuB,QAAQ,CAACvB,IAFb;IAGA,MAAM,CAACiH,QAAD,EAAWC,MAAM,GAAI,EAArB,IAA0BF,gBAAgB,CAACG,KAAjB,CAAwB,GAAxB,CAAhC;IAEA,MAAM;MAAEC;IAAF,IAAWZ,sBAAsB,CACrCC,KAAK,CAACY,aAAN,CACEd,kBAAkB,CAACe,QADrB,EAEE;MAAExD,KAAK,EAAEnC;IAAT,CAFF,EAGE,CACE;IACA8E,KAAK,CAACY,aAAN,CACEE,2BADF,EAEE;MAAE1D,GAAG,EAAG,mCAAR;MAA4C2D,GAAG,EAAEjG,QAAQ,CAACvB;IAA1D,CAFF,EAGE,CACEyG,KAAK,CAACY,aAAN,CAAoBX,KAAK,CAACjC,OAA1B,EAAmC;MACjCZ,GAAG,EAAG,wBAD2B;MAEjC4D,IAAI,EAAElG,QAAQ,CAACmG,MAAT,CAAgBD,IAFW;MAGjCE,WAAW,EAAEpG,QAAQ,CAACmG,MAAT,CAAgBC,WAHI;MAIjC;MACAC,QAAQ,EAAE;QACRX,QADQ;QAERC,MAFQ;QAGRW,IAAI,EAAG;MAHC;IALuB,CAAnC,CADF,CAHF,CAFF,CAHF,CADqC,EAyBrC7G,IAAI,CAACC,KAAL,CACEH,gBAAA,CAAGgH,YAAH,CACE9H,IAAI,CAACD,IAAL,CACEY,OAAO,CAACC,GAAR,EADF,EAEG,QAFH,EAGG,mBAHH,EAIG,eAJH,CADF,EAOG,MAPH,CADF,CAzBqC,EAoCrC;MACE;MACA;MACAmH,OAAO,EAAEtF,KAAK,IAAI;QAChB,MAAMuF,qBAAuC,GAAGvF,KAAhD;QAEAuF,qBAAqB,CAACtD,OAAtB,GAAgC;UAC9B1E,IAAI,EAAEuC,QADwB;UAE9BkB;QAF8B,CAAhC;QAKAqD,MAAM,CAACmB,IAAP,CAAa,OAAb,EAAqBxF,KAArB;MACD;IAZH,CApCqC,CAAvC;IAoDA,MAAM,IAAIyF,OAAJ,CAAkB,CAACC,OAAD,EAAUC,MAAV,KAAqB;MAC3CtB,MAAM,CAACuB,EAAP,CAAW,OAAX,EAAoB5F,KAAD,IAA6B;QAC9C2F,MAAM,CAAC3F,KAAD,CAAN;MACD,CAFD;MAIAqE,MAAM,CAACuB,EAAP,CAAW,OAAX,EAAmB,MAAM;QACvBF,OAAO;MACR,CAFD;MAIAf,IAAI,CAACN,MAAD,CAAJ;IACD,CAVK,CAAN;EAWD;AACF;;AA6BM,eAAewB,YAAf,CAA4B;EACjCC,MADiC;EAEjCtF,yBAFiC;EAGjCT,SAHiC;EAIjCgG;AAJiC,CAA5B,EAUW;EAChB,MAAMrI,qBAAqB,GAAG4D,OAAO,CAACd,yBAAD,CAArC;;EAEA,KAAK,MAAM;IAAEwF,OAAF;IAAWC,KAAX;IAAkB9C,SAAlB;IAA6B+C;EAA7B,CAAX,IAAyDH,WAAzD,EAAsE;IACpE,MAAMI,UAAU,GAAGL,MAAM,CAACM,IAAP,CAAYC,CAAC,IAAIA,CAAC,CAAC,CAAD,CAAD,KAASlD,SAA1B,CAAnB;;IACA,IAAI,CAACgD,UAAL,EAAiB;MACf,MAAM,IAAIG,KAAJ,CACH,eAAcnD,SAAU,mCADrB,CAAN;IAGD;;IAED,MAAM,CAACoD,SAAD,EAAYC,KAAZ,IAAqBL,UAA3B;IAEA,MAAMjH,kBAAkB,GAAG,MAAMnB,sBAAsB,CACrDyI,KAAK,CAACvH,kBAD+C,CAAvD;IAIA,MAAMwH,qBAAqB,GAAI,wBAA/B;IACA,MAAM1E,SAAS,GAAG,MAAM,IAAA2E,wBAAA,EAAc3G,SAAd,EAAyByG,KAAK,CAACjE,IAA/B,CAAxB;;IAEA,IAAI;MAAA;;MACF,MAAMnC,IAAI,GAAG,MAAM1C,qBAAqB,CAACiJ,WAAtB,CAAkC;QACnDH,KADmD;QAEnDtH,kBAFmD;QAGnD+G,KAAK,EAAE;UACLjB,IAAI,EAAEjD,SAAF,aAAEA,SAAF,4CAAEA,SAAS,CAAEkD,MAAb,sDAAE,kBAAmBD,IADpB;UAEL,IAAIkB,WAAW,GAAG;YAAEU,QAAQ,EAAEH;UAAZ,CAAH,GAAyC,EAAxD,CAFK;UAGL,GAAGR;QAHE;MAH4C,CAAlC,CAAnB;MASA,MAAMvB,KAAK,GAAGtE,IAAI,CAACsE,KAAL,CAAW+B,qBAAX,CAAd,CAVE,CAYF;;MACA,IAAII,KAAK,GAAG,CAAZ;;MACA,KAAK,MAAMC,SAAX,IAAwBpC,KAAxB,EAA+B;QAC7B,MAAM,IAAAqC,oCAAA,EACJxJ,IAAI,CAACD,IAAL,CAAUyC,SAAV,EAAsB,SAAtB,EAAiC,QAAjC,EAA2C,GAAEiG,OAAQ,IAAGa,KAAM,OAA9D,CADI,EAEJC,SAFI,CAAN;QAIAD,KAAK;MACN;IACF,CArBD,CAqBE,OAAOG,GAAP,EAAY;MACZ,MAAMC,gBAAuC,GAAGD,GAAhD;MACAC,gBAAgB,CAAChF,OAAjB,GAA2B;QACzBkB,SADyB;QAEzBpB,SAFyB;QAGzBmF,UAAU,EAAEjB;MAHa,CAA3B;MAKA,MAAMgB,gBAAN;IACD;EACF;AACF"}